--------------------[TODO]-----------------------
20240304UOB4OZNG
20240403CURKSP9H
20240505WAWGVWGE

美化

建造器的 点击panel美化
建造的时候可以在右下角显示当前建造物品的详细信息

移动的时候会卡顿 不知道是不是cinemachine的锅
constructor 现在可以用可序列化的字典了



无人机敌人的炮塔


组件扣血

维修组件 全境封锁维修蜂巢

炮塔
    动能能量
    能量
    导弹


剩余的一些必要的基础物件:
    墙体
    护盾

    范围收集器

    引擎
    

游戏的保存和结束回港

游戏大体逻辑:
    [loop]
    1 停泊 港口 
    2 副本 获得资源
        副本中采用坚持3分钟 应对不断来袭的敌人 获得资源
    3 港口 解锁科技 购买buff 

场景切换

panel 动画

接入steam的sdk
 
costPanel 可以做一个折叠 动画


弹道增加, 特效
填入更多炮塔 激光, 导弹


---------------------[OnProcess]----------------------



new
港口
港口可以购买解锁新的升级和蓝图

更改玩法

比例先做成1:4



TODO
有时候飞船飞着飞着会顿一下 没有查明原因

优化: 子弹的代码的策略模式可能之后需要特效之类的话 也需要改成监视器面板模组类型的策略模式





TODO:


建造的逻辑可能要改
1 在建造面板时候 如果没有选择要建造的unit 鼠标放在有unit的地方要显示拆除的图标
2 在建造面板时候 如果选择了要建造的unit 鼠标放在有unit的地方 要关闭虚影 并显示一个红色的虚影 以及unit拆除图标

明天:
在商店面板的显示一个tech tree relic的收集 // 暂定是如果是一个可以升级的物品 加一个 蓝图需求的描述, 鼠标放上去会显示哪些蓝图需求
跳转战斗场景跳转前保存当前的飞船和仓库数据 command

每一关用怪物的个数来表示

战斗场景的


open/close by e

旋转bug
鼠标旋转
保存event

无人机收集改为一个武器 (后续)

---------------------[Done]---------------------------------

2024-5-6
new
start scene
核心吸收货币而不是用无人机
start scene 现在可以直接跳转到战斗场景了
添加了scenemodel 来存储一些跨场景的数据
比如表示playermodel 有没有初始化 (从本地导入的初始化或者是一个自动的初始化)

fix
启动引擎按钮之后要保存当前的飞船memento 

2024-5-4
new
现在可以正常跳转了 战斗场景结束后会自动跳转到下一关商店
但是因为场景测试是直接读取的存档 unit和ship的数据并没有保存需要用一个
dubugmodel来保存下一个场景是直接加载存档还是不加载直接使用model

2024-5-2
new
物品会达到上限不在增加 上限的标准再itemSO中

2024-5-1
战斗场景 场景倒计时面板系统
stageinfo model (关卡的index 如果之后需要保存得放在player model中)

2024-4-28
new
发动引擎按钮现在不会再打开选择关卡页面 而是等玩家双击确认后直接跳转到战斗场景
添加了stageinfo so来对战斗场景每一关的参数进行规整
添加了异步跳转场景的command

2024-4-27
new
添加了中英文都支持的字体 textmesh pro默认的字体不支持中文, 可以通过更改fallback assets在获取失败

2024-4-24
new
遗物解锁system 现在会保存玩家购买的东西并且根据购买自动解锁可购买的科技到 playermodel中 
(唯一还有一点之后如果是要中途保存 得把boughtunit也保存到model然后转到本地数据中)

2024-4-23
new
ui变化 显示tech tree的ui
开始写PlayerTechTreeRelicSystem 用来自动判断能否获取遗物


2024-4-22
new
通过build和拆除command来实现建造和拆除的逻辑
拆除和建造command中通过unit inventory来进行建造

开始写 relic 生成了几个relic

2024-4-11
new 
建造面板ui现在会根据playermodel的unit仓库来显示可以建造的unit

2024-4-10
fix
修改了eventcenter的 加入了判断如果有事件没有取消订阅而导致执行失败

2024-4-5
new
商店现在可以购买 购买后product icon会消失
物品会进入到playermodel的仓库中但是显示的ui还没做

0.6.2
2024-4-3
new 
导入了qframework 分离了一下buildcontroller的代码
学习command controller model的使用 command 传参可以传一个new command实例来执行
fix
playermodel 使用了bindableproperty 来存储currency
添加了currency如果更改会触发事件中心事件

----note---
可以向qframework 中一样通过扩展方法给接口实现一个default方法 所有实现了接口就自动获得了扩展方法
注意: 如果是通过实现接口获得的扩展方法 在实现的实例类中如果要调用必须要使用this : 比如 this.SendCommand()
注意: 扩展方法会被相同名称和签名的方法覆盖 : https://learn.microsoft.com/zh-cn/dotnet/csharp/programming-guide/classes-and-structs/extension-methods
----end note---

2024-4-1
fix
维护shipbuildcontroller的代码
shipbuildcontroller只负责建造的逻辑
需要建造什么的逻辑放到了shipbuildpanel中 中间的通讯用eventcenter解耦合

2024-3-30
商店刷新 扣钱
装备解锁系统

2024-03-19

learn:
zenject 依赖性注入框架 正在学习中
现阶段还是用于解决 如果一个类需要另一个类的时候需要new一个的问题 并且是一直不需要改变的类 还有有一些场景才需要的单例可以使用

还需要找一下如何可以绑定一下mono实例到container中 看到的是通过bind组件的方式来绑定的
之后就要看如何获取

new
spaceport shop model
spaceport shop ui
spaceport shop product ui

2024-03-16
new
v2
智能子弹炮塔

2024-03-15
new
导弹塔 导弹子弹(之后还要优化一下导弹的轨迹) 导弹重定向  

fix
炮塔 优化代码 添加了turret判空

2024-03-13
优化子弹策略模式改为模块策略模式
深化策划 想如何让玩家 "有策略性的变强"

2024-03-12
0.6.1
new
炮塔发射逻辑添加了中介者模式 可以通过组件动态更改参数来影响子弹的行为 比如散射和随机方向
(暂时 连射逻辑还没有组合上去 但是参数已经加上去了)

在eventcenter 中添加了一个泛型优先级事件

fix
子弹的策略模式正在改造为 组件策略模式 这样一些比如fx就可以放在策略中而不是只能 依赖于context


2024-03-11
设计炮塔类型
炮塔不但整合了策略模式还整合了中介者模式

2024-03-10

new
v1
随机子弹炮塔, 散射子弹炮塔
v2
连射炮塔

2024-03-08
new
线不管货币 暂时还是改为了独立货币
炮塔 做一级支线: 散射炮塔 炮塔添加了策略模式
子弹工厂改用了 参数对象模式

fix
子弹之前是 设置了target 自动向target飞去 
但是如果需要做散射的炮塔 应该是直接设置dir 然后让子弹朝dir的方向飞去
现在怎家了子弹参数对象 并且子弹不但需要传参target 也需要传参dir

2024-03-07
研究player model到底要不要改一个货币出来

更改为独立货币好处:
性能(有但如果item少于20个几乎没有)
因为之后点科技和建造都会需要货币完成 可以省略每次都需要填入一个 itemSO iron
方便查看和管理

但是
之后如果需要更改一个射出金币的炮塔就需要额外的代码

不更改
有高自由度和可扩展性

但是ui可能会不好写 (也还好写)


2024-03-06
new
1x1 GT 炮塔线
playermodel 增加currency货币来替代一直使用仓库中的铁

或者可以保留 那就item 增加一个属性 代表是材料还是弹药

如果要替代 那么 如果之后需要扩展能射出 钱(iron)作为子弹的时候 用itemso 会遇到每次需要判断type


0.5.5 
2024-3-5
new
如果扣血到没有则显示一个虚影物体
受损组件通用的表示离线的视觉效果改成一个新的 模块 更加模块化
受到伤害会跳数字显示

fix
把玩家炮塔也添加Gizmos绘制表示射程范围的圆形

0.5.4
2024-03-04
new
组件如果扣血扣完了会变成受损组件 需要重新修复到100 血才会恢复

fix
修复 可以修复完全受损的组件

2024-03-03
子弹扣血 文字位置随机偏移 

0.5.3
2024-03-02
new
COre一开始可以进行一些修复
修复组件 先安装在核心上 之后还需要再来一个修复组件
通用扣血

fix
新的力控制飞船移动


2024-03-01
new
护盾系统完工

fix
修改文字显示系统 改为使用text mesh pro 更清晰

2024-2-29
现在可以显示文字作为描述组件细节

2024-2-28
fix
现在可以通过力来控只enemy移动 更有太空狗斗的感觉
写了一下午 但调几个数据有点难
而且要的值很多 不是很方便写入enemySO 考虑新建运动SO


0.5.2
2024-2-27
new
整体调整了美术风格往大色块去靠 实在是不会画画了 大色块的几何会更统一一些
通过新建的shader达到效果
敌人的设计还算好 飞船除了炮塔其他的还需要再继续调整 之后美术再调整

飞船炮塔代码实现

fix
炮塔添加了 OnDrawGizmosSelected 这样可以在场景中看见范围

0.5.1
2024-2-26

护盾图片
护盾shader
护盾代码
护盾物体现在能放置并且初始化了

fix
修改收到伤害改为使用一个新的信息类
UnitSO 获取unit点的偏移修复了 之前x, y没有换导致建造的虚影位置不对

2024-2-25
0.5.0
动能火炮炮塔
动能火炮炮弹 (范围伤害引信)
projectileSO 添加了范围
projectileSO 添加了识别的

添加了对象池 子弹生成自动添加到对象池中 
修改了子弹生成工厂的函数 并且如果调用 Projectile.Destroy 是直接回收到对象池中

2024-2-23
确认了生产线游戏模式的改动

更改了子弹的逻辑 提取出了策略模式

new
无限弹药机
大炮

fix
更改了turret 现在能从仓库提取弹药了
INF机器中间的图标显示修改为依赖sprite X 改为sprite就不能用hdr了

2024-2-21 and 22
考虑减法
头脑风暴 设计新玩法
线缆点对点运输 X
删除传送带 直接进仓库

fix
EventCenter有时候物体消失了没有把事件注销 增加try catch一定程度避免程序被卡死

fix
保存的时候只能保存物体是什么, 不能保存物体的具体数据 比如制造机选用的是哪个配方

4.13.0
2024-2-20
new
简单关卡跳转
添加了 costpanel 小动画
spceport onlyWASDCameraFacade 控制太空港相机移动
太空港现在也可以建造了



fix
shipbuildcontroller 对于cost panel的管理逻辑修改
constructor 选择配方的panel 由于drop down 没有在最后所以点不到 (之后可以用新的dropdwon 之前视频那个)
fix
建造模式退出的时候如果 选取了东西然后直接按e退出建造模式 显示cost的ui还是会在虚影是不见了
fix
保存添加了一个extra data 来保存比如制造机的配方 现在可以保存了但是还不能读取


4.12.0
2024-2-19
fix
costItem ui 会导致 unity 光线投射目标改变从变回 build action map

new
添加了text animator
港口显示资源和进入关卡选择
完善了port场景 点击左下角打开关卡选择 (之后要做动画)
差一个跳转

2024-2-18
unitInfoModel 负责索引全部的unitSO
itemInfoModel 负责索引全部的itemSO
通用 工具类增加了可以log 带类名和方法名的方法 

fix
飞船有时候save 的时候没有任何组件
bug 原因是load的时候组件生成没有绑定到 

2024-2-17
建立了Player model单例
uml类图
https://www.processon.com/diagraming/65d0570cc928476241774147

fix
player model 结构改变



2024-2-2

new
本地存档内容
ship memento
保存使用json 但是如果直接保存的Vector2Int 当作 grid 的位置 会把模长那些全部保存过去 还是直接用 x 和 y 吧

playerMemento
保存飞船也保存仓库

读取
战斗场景读取
逻辑: 暂时的
先是game manager需要读取玩家存档 PlayerMemento
读取了之后触发读取EventCenter事件 PlayerMementoLoad
飞船带有事件回调会根据事件中的值来加载飞船

飞船要根据shipmemento 里面的值来加载数据
就需要一个model类字典来管理所有的unitSO 负责根据存档里面的unitname来索引全部的

2024-2-1
保存飞船和仓库的json

2024-1-31

new
事件中心写了一个 : EventCenter

建造的时候旁边显示要建造需要什么东西 (这个需要用事件中心吗?)
显示的面板 监听 shipbuildController 的curbuild 如果curbuild 换了就 refresh
并且监听inventory的inventory change 如果inventory里面有物品增加或者减少也会显示在建造的详细面板上面
没用事件中心

fix
建造的时候不能删除


2024-1-30

new
得更改交互逻辑 不然一按右键这边直接退出了建造模式 
按下 e 建造模式 done
    旁边的面板可以选择建造什么  done
    左键建造右键清空建造的选择  done
    如果手上没有东西此时也能check detail (鼠标左键) done
再次按下 e 退出建造模式 done

new
改变 curbuild 了之后 ui也需要一起改变:
在build controller 中添加一个 event 当cur build unit 改变的时候触发
并且将 ui 的设置选择flag的添加进去

fix
shadowoerfreame 改为每次判定需不需要显示可以保证万无一失

fix
如果在ui界面点击后也会导致建造
新建了一个input action map 叫ui 从而可以关闭执行回调
以及 AutoSwitchInputAction 鼠标移动进去的时候改变map为 ui 退出的hi后改变为 进入前记录的




2024-1-29

new
开启建造模式后, 我需要视角不在随鼠标晃动而晃动而是通过wasd来移动视角

Camera1:
looktargeByMouse 
在一般移动模式下面 视角不但跟随飞船 而且还需要根据鼠标的移动可以进行观察
可以进行zoom 放大缩小

Camera2:
建造模式或者停靠港口只能进行编辑的时候使用 WASD 或者鼠标移动到边界的时候移动视角
也可以进行zoom 放大缩小

切换想达到的效果 按下e键之后 镜头切换到现在屏幕的中间(looktarget) 并且上下左右与飞船对齐
切换回来则是反过来target直接根据鼠标位置做移动 并且上下左右与世界对齐   =-

分开两个camera / 单独对一个camera进行调整参数?
切换的时候两个相机的参数有的会不一样 玩家拉大了时候开始编辑又需要缩小
一个:
切换的时候
把aim 从donothing 变成same 并且只需要
一个的方法遇到障碍 无法改变aim 从donothing 到 same follow

完成的:
还是用两个的来完成

fix
没有打开建造模式的时候不再显示gridobject 的坐标改为打开后在现实 (现在先把这个去掉了 之后用textpro更清晰一点)
(按理说应该一直不显示 或者保留让玩家选应该显示与否)
INF 资源机器的贴图生成有问题 会根据世界坐标系来进行生成




2024-01-28
建造与建造面板
建造面板 进入建设模式打开 退出建造模式关闭
建造面板, 可以通过点击上面的unit来选择建造什么unit
建造面板选择符号动画
建造需要一个获取现在能建造的东西 先用SO来实现

两格的机械臂 (未测试)

2024-01-01 ~ 2024-01-28
未记录